#!/bin/bash

source /usr/local/bin/devops-func.sh
MODE="write"

number_of_arguments=$#

if [ $number_of_arguments -eq 1 ]; then
    file_path="$1"
fi
if [ $number_of_arguments -eq 2 ]; then
    argument="$1" # -r, -rf, -f
    file_path="$2" # file path
    shift
fi

if [ $number_of_arguments -eq 2 ]; then
    allowed_parameters=0
    if [ "$argument" == "-r" ] || [ "$argument" == "-rf" ] || [ "$argument" == "-f" ]; then
        allowed_parameters=1
    fi
    if [ $allowed_parameters -eq 0 ]; then
        echo "ERROR: First argument must be: -r, -rf, or -f"
        exit 1
    fi
fi

startup_checks "$MODE" "$file_path"
is_allowed_path_for_mode "$MODE" "$file_path"

if [ $number_of_arguments -eq 1 ]; then
    /usr/bin/rm "$file_path"
elif [ $number_of_arguments -eq 2 ]; then
    /usr/bin/rm $argument "$file_path"
fi

exit $?
